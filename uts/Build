#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License, Version 1.0 only
# (the "License").  You may not use this file except in compliance
# with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
# Copyright 2011, 2012, 2013 Oracle, Inc.  All rights reserved.
# Use is subject to license terms.

uts_DIR := $(current-dir)

# linux/dtrace_cpu_defines.h is #included by the DTrace kernel headers, but is
# not marked uapi so is not installed.  So we install a stripped-down copy of it
# into linux/ ourselves.  dtrace.h and dtrace_types.h are unique to this
# userspace tree.

SYS_HEADERS_INSTALL := common/sys/dtrace.h \
                       common/sys/dtrace_types.h \
                       common/sys/sdt.h

LINUX_HEADERS_INSTALL := common/linux/dtrace_cpu_defines.h

install::
	mkdir -p $(INSTINCLUDEDIR)/sys
	$(call describe-install-target,$(INSTINCLUDEDIR)/sys,$(notdir $(SYS_HEADERS_INSTALL)))
	cd $(uts_DIR) && install -m 644 $(SYS_HEADERS_INSTALL) $(INSTINCLUDEDIR)/sys
	mkdir -p $(INSTINCLUDEDIR)/linux
	$(call describe-install-target,$(INSTINCLUDEDIR)/linux,$(notdir $(LINUX_HEADERS_INSTALL)))
	cd $(uts_DIR) && install -m 644 $(LINUX_HEADERS_INSTALL) $(INSTINCLUDEDIR)/linux
